<?xml version="1.0" encoding="utf-8"?>
<body name="body" class="sys_normal" headerScript="var operateType,p;" caption="组织架构维护">
	<folder name="datasource"><extAjax onSuccess="extShowMessage('保存成功');extCall(findMenu);p.reload();" name="insertAjax" out="panel3,menu" onFailure="var s = response.responseText;&#xA;extShowExcept(s);" url="main?action=webbuilder/application/partmanager/system/orgManage/insert.xwl"/><extAjax onSuccess="extShowMessage('修改成功');&#xA;var r=extUpdateFromControl(grid,'panel3');&#xA;&#xA;r.commit();" name="updateAjax" out="extWindow" onFailure="var s = response.responseText;&#xA;extShowExcept(s);" url="main?action=webbuilder/application/partmanager/system/orgManage/update.xwl"/><extAjax onSuccess="extRemoveGridSelection(grid);&#xA;extResetAllControlsValue('panel3');&#xA;p.reload();" out="grid,menu" name="ajaxdelete" onFailure="var s = response.responseText;&#xA;extShowExcept(s);" url="main?action=webbuilder/application/partmanager/system/orgManage/delete.xwl"/><extStore name="store" onAfterLoad="grid.getSelectionModel().selectRow(0);  &#xA;	var len=grid.getStore().getCount();&#xA;if(len&gt;0){&#xA;operateType = 'modify';&#xA;	var record = grid.getSelectionModel().getSelected();&#xA;&#xA;	extSetAllControlsValueObj(panel3, record.data);&#xA;	OLD_PARTS_TYPE.setValue(record.get('PARTS_TYPE'));&#xA;}" url="main?action=webbuilder/application/partmanager/system/orgManage/select.xwl"/></folder><extMenu name="menu"><extLabel name="extLabel81" caption="名称："/><extTextField name="pmNam"/><extMenuItem caption="查询" iconCls="icon_find" name="findMenu" onClick="store.baseParams=extGetAllControlsValue('menu');&#xA;store.load({params:{start:0,limit:30}});"/><extMenuItem name="addMenu" iconCls="icon_new" onClick="extResetAllControlsValue('panel3');&#xA;&#xA;if(Ext.getCmp(&quot;parCod&quot;).getValue()=='')&#xA;{&#xA;	extShowMessage(&quot;请选择树节点&quot;);&#xA;	return;&#xA;}&#xA;else&#xA;{	operateType = 'insert';&#xA;	PARENT_COD.setValue(Ext.getCmp(&quot;parCod&quot;).getValue());&#xA;        extWindow.show();&#xA;}" caption="新增"/><extMenuItem name="edit" caption="编辑" iconCls="icon_edit" onClick="if (grid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一条数据。');&#xA;	return;&#xA;}else{&#xA;	var record = grid.getSelectionModel().getSelected();&#xA;	extSetAllControlsValueObj(panel3, record.data);&#xA;	OLD_C_ORG_NAM.setValue(record.get('C_ORG_NAM'));&#xA;        operateType = 'modify';&#xA;	extWindow.show();	&#xA;}"/><extMenuItem name="del" caption="删除" iconCls="icon_delete" onClick="if (grid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一条数据。');&#xA;	return;&#xA;}else{&#xA;var record = grid.getSelectionModel().getSelected();&#xA;extGridDeleteConfirm(grid,&quot;C_ORG_NAM&quot;,ajaxdelete);&#xA;		&#xA;}"/><extTextField hidden="true" name="parCod"/></extMenu><extColumnModel name="columnModel"><extColumn caption="序号" type="rowNum" name="rownum"/><extColumn align="center" hidden="false" fieldName="ORG_COD" name="ORG_CODs" caption="代码"/><extColumn caption="名称" fieldName="C_ORG_NAM" name="C_ORG_NAMs"/><extColumn caption="主管领导" name="MAIN_MANs" fieldName="MAIN_MAN"/><extColumn caption="副领导" name="VICE_MANs" fieldName="VICE_MAN"/><extColumn caption="备注" fieldName="REMARKS" name="REMARKSs"/></extColumnModel><extWindow name="extWindow" closeAction="hide" frame="true" width="500" height="223" layout="absolute" onOk="if (!extVerifyAllControls('panel3')) return; &#xA;extShowMessage(operateType );&#xA;if(operateType == 'modify'){&#xA;  updateAjax();&#xA;}&#xA;else if(operateType == 'insert'){&#xA;  insertAjax()&#xA;}&#xA;else&#xA;{&#xA;	extShowMessage('请选择是新增还是修改！');&#xA;	reutrn;&#xA;}&#xA;extWindow.hide();" caption="编辑"><extPanel name="panel3" border="false" layout="absolute" width="465" region="center" frame="true" height="158" left="10" top="10"><extLabel name="extLabel" left="15" top="160" width="65" caption="代码："/><extTextField left="90" top="205" width="70" disabled="true" hidden="true" name="ORG_COD"/><extLabel name="extLabel11" left="180" top="165" width="80" caption="父节点："/><extTextField left="270" top="160" width="120" disabled="true" hidden="true" name="PARENT_COD"/><extLabel name="extLabel3" left="10" top="10" width="70" html="&lt;font  color='red'&gt;*&lt;/font&gt;名称："/><extTextField left="90" top="5" width="345" maxLength="25" allowBlank="false" name="C_ORG_NAM"/><extLabel name="extLabel2" left="25" top="70" width="55" caption="备注："/><extTextField left="90" top="60" width="345" inputType="textArea" height="70" name="REMARKS" maxLength="100"/><extTextField left="225" top="220" width="120" hidden="true" name="OLD_C_ORG_NAM"/><extTextField left="90" top="30" width="135" name="MAIN_MAN"/><extTextField left="295" top="30" width="140" name="VICE_MAN"/><extLabel name="extLabel1" left="10" top="35" width="70" caption="主管领导："/><extLabel name="extLabel4" left="235" top="35" width="55" caption="副领导："/></extPanel></extWindow><extViewPort name="viewPort" layout="border"><extPanel name="panel" border="false" region="west" width="200" layout="fit" height="100%" caption="组织架构树"><extTree name="tree" autoScroll="true" onBeforeLoad="control.baseParams.id=node.id;" onClick="Ext.getCmp(&quot;parCod&quot;).setValue(node.id);&#xA;Ext.getCmp(&quot;pmNam&quot;).setValue(node.text);&#xA; extCall(findMenu);&#xA;p=node;" remoteUrl="main?action=webbuilder/application/partmanager/system/orgManage/jsonQuery.xwl"/></extPanel><extPanel name="panel1" border="false" region="center" layout="border" tbar="menu" frame="true" hideMode="display"><extPanel name="panel2" border="false" layout="fit" region="center" height="200"><extGrid name="grid" columnsModel="columnModel" pageSize="30" store="store" loadStore="false" onRowDblClick="extCall(edit);"/></extPanel></extPanel></extViewPort></body>
