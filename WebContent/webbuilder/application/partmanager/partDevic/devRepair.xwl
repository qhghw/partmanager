<?xml version="1.0" encoding="utf-8"?>
<body name="body" compact="true" class="sys_normal" headerScript="var operateType;&#xA;var operateType1;" caption="设备故障处理记录">
	<folder name="folder"><extStore name="store" onAfterLoad="grid.getSelectionModel().selectRow(0); &#xA;var len=grid.getStore().getCount();&#xA;if(len&gt;0){&#xA; var record = grid.getSelectionModel().getSelected();&#xA;extSetAllControlsValueObj(extWindow, record.data);&#xA;operateType = 'modify';&#xA;}&#xA;else &#xA;operateType = 'insert';" url="main?action=webbuilder/application/shipmanager/shipDev/devRepair/select.xwl"/><extAjax name="deleteAjax" out="grid" onSuccess="extRemoveGridSelection(grid);" url="main?action=webbuilder/application/shipmanager/shipDev/devRepair/delete.xwl"/><extStore name="store1" url="main?action=webbuilder/application/shipmanager/common/shipSelect.xwl"/><extStore name="shipDevStore" url="main?action=webbuilder/application/shipmanager/shipDev/devAccident/selectdev.xwl"/><extStore name="hichStore" url="main?action=webbuilder/application/shipmanager/common/hichSelect.xwl"/><extAjax name="insertAjax" onFailure="var s = response.responseText;&#xA;extShowExcept(s);" onSuccess="extShowMessage('新增成功！');extCall(findMenu);&#xA;extWindow.hide();" out="menu,extWindow" url="main?action=webbuilder/application/shipmanager/shipDev/devRepair/insert.xwl"/><extAjax name="updatetAjax" onFailure="var s = response.responseText;&#xA;extShowExcept(s);" onSuccess="extShowMessage('修改成功！');extCall(findMenu);extWindow.hide();" out="menu,extWindow" url="main?action=webbuilder/application/shipmanager/shipDev/devRepair/update.xwl"/><extStore name="mainTypStore" url="main?action=webbuilder/application/shipmanager/smCode/devMainTainCod/typSelect.xwl"/><extStore name="chooseStore" url="main?action=webbuilder/application/shipmanager/common/cShipSelect.xwl"/><extStore name="chooseStore1" url="main?action=webbuilder/application/shipmanager/common/cShipdataSelect.xwl"/></folder><folder name="folder1"><extColumnModel name="columnCertificate"><extColumn name="column21" caption="序号" type="rowNum"/><extColumn name="CERTI_NAMC" fieldName="C_SHIP_NAM" caption="中文船名"/><extColumn name="CERTI_NBRC" fieldName="C_DEV_NAM" caption="设备名称"/><extColumn name="SIGN_PORT_NAMC" caption="设备中文名" fieldName="C_DEV_NAM"/><extColumn name="SIGN_DTEC" caption="设备英文名" fieldName="E_DEV_NAM"/><extColumn name="MATURITY_DTEC" caption="是否报修" fieldName="UP_ID" renderer="if(value=='0')&#xA;return '否';&#xA;else if(value=='1')&#xA;return '是';" width="80"/><extColumn name="RECORD_MANC" caption="报修人" fieldName="APPLY_MAN_COD" width="60"/><extColumn name="SHIP_CODCD" hidden="true" caption="报修部门" fieldName="APPLY_DEPT_COD" width="80"/><extColumn name="column" caption="报修日期" fieldName="APPLY_TIM" type="datetime" renderer="if(value==''||value==null)&#xA;{&#xA;        return  &quot;&quot;;&#xA;}else&#xA;{&#xA;        return  value.format('Y-m-d');  &#xA;      &#xA;     &#xA;}&#xA;"/><extColumn name="column1" caption="是否派工" fieldName="ASSIGN_ID" renderer="if(value=='0')&#xA;return '否';&#xA;else if(value=='1')&#xA;return '是';" width="80"/><extColumn name="column2" caption="派工员" fieldName="ASSIGN_MAN_COD" width="60"/><extColumn name="column3" caption="派工部门" fieldName="ASSIGN_DEPT_COD" width="80"/><extColumn name="column4" caption="派工日期" fieldName="ASSIGN_TIM" type="datetime" renderer="if(value==''||value==null)&#xA;{&#xA;        return  &quot;&quot;;&#xA;}else&#xA;{&#xA;        return  value.format('Y-m-d');  &#xA;      &#xA;     &#xA;}"/><extColumn name="column5" caption="是否完成维修" fieldName="FINISH_ID" renderer="if(value=='0')&#xA;return '否';&#xA;else if(value=='1')&#xA;return '是';"/><extColumn name="column6" caption="反馈部门" fieldName="FEEDBACK_DEPT_COD" width="80"/><extColumn name="column7" caption="反馈人" fieldName="FEEDBACK_MAN_COD" width="60"/><extColumn name="column8" caption="反馈时间" fieldName="FEEDBACK_TIM" type="datetime" renderer="if(value==''||value==null)&#xA;{&#xA;        return  &quot;&quot;;&#xA;}else&#xA;{&#xA;        return  value.format('Y-m-d');  &#xA;      &#xA;     &#xA;}&#xA;"/><extColumn name="column9" caption="故障现象描述" fieldName="DEV_HITCH_EXPRESS"/><extColumn name="column10" caption="故障部位" fieldName="DEV_PART_COD" width="80"/><extColumn name="column11" caption="故障原因" fieldName="DEV_HITCH_REASON" width="150"/><extColumn name="column12" caption="故障解决方法" fieldName="DEV_HITCH_RESOLVENT" width="200"/><extColumn name="column13" caption="开工时间" fieldName="BEGIN_TIM" type="datetime" renderer="if(value==''||value==null)&#xA;{&#xA;        return  &quot;&quot;;&#xA;}else&#xA;{&#xA;        return  value.format('Y-m-d');  &#xA;      &#xA;     &#xA;}&#xA;"/><extColumn name="column14" caption="完工时间" fieldName="END_TIM" type="datetime" renderer="if(value==''||value==null)&#xA;{&#xA;        return  &quot;&quot;;&#xA;}else&#xA;{&#xA;        return  value.format('Y-m-d');  &#xA;      &#xA;     &#xA;}&#xA;"/><extColumn name="column15" caption="故障是否修复" fieldName="REPAIR_ID" renderer="if(value=='0')&#xA;return '否';&#xA;else if(value=='1')&#xA;return '是';"/><extColumn name="column16" caption="验收意见" fieldName="PROCESS_DES" width="200"/></extColumnModel></folder><extMenu name="menu" style="" bodyStyle="" autoShow="false"><extLabel name="extLabel811" caption="选船："/><extComboBox mode="local" name="shipNam" displayField="NAME" valueField="ID" store="chooseStore1" loadStore="true" listWidth="200" pageSize="15" minChars="2" forceSelection="true" onSelect="var  s=this.value;&#xA;&#xA;shipCod.setValue(s.split('(')[0]);&#xA;eShipNam.setValue(s.split('-')[1].split(')')[0]);&#xA;cShipNam.setValue(s.split('(')[1].split('-')[0]);"/><extLabel name="extLabel8111" caption="设备名称："/><extTextField name="cDevNam"/><extMenuItem caption="查询" iconCls="icon_find" onClick="if(shipCod.getValue()=='')&#xA;{&#xA;	extShowMessage('请选择一条船！');	&#xA;return ;&#xA;}&#xA;&#xA;&#xA;var  whereSql=&quot;  and  1=1&quot;;&#xA;if(shipCod.getValue()!='')&#xA;{&#xA;	whereSql+=&quot;  and  SHIP_DEV_NO  ='&quot;+shipCod.getValue()+&quot;' &quot;;&#xA;}&#xA;if(cDevNam.getValue()!='')&#xA;{&#xA;	whereSql+=&quot;  and  ( C_DEV_NAM  like '%&quot;+cDevNam.getValue()+&quot;%'  or E_DEV_NAM  like '%&quot;+cShipNam.getValue()+&quot;%'  )&quot;;&#xA;&#xA;}&#xA;store.baseParams.WhereSql =whereSql;&#xA;store.load({params:{start:0,limit:30}});" name="findMenu"/><extMenuItem caption="新增" iconCls="icon_new" onClick="operateType = 'insert';&#xA;if(shipCod.getValue()=='')&#xA;{&#xA;	extShowMessage('请选择一条船！');	&#xA;return ;&#xA;}&#xA;&#xA;extWindow.show();&#xA;extResetAllControlsValue('extWindow');" name="addMenu"/><extMenuItem caption="修改" iconCls="icon_edit" onClick="operateType = 'modify';&#xA;if (grid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一个有效的条目。');&#xA;	return;&#xA;}else{&#xA;	extWindow.show();&#xA;var record = grid.getSelectionModel().getSelected();	&#xA;extSetAllControlsValueObj(extWindow, record.data);&#xA;&#xA;}" name="editMenu" hidden="false"/><extMenuItem caption="删除" iconCls="icon_delete" onClick="extGridDeleteConfirm(grid,'C_SHIP_NAM',function(){&#xA;	deleteAjax();&#xA;});" name="delMenu"/><extTextField name="shipCod" hidden="true"/><extTextField name="cShipNam" hidden="true"/><extTextField name="eShipNam" hidden="true"/></extMenu><extWindow name="extWindow" closeAction="hide" frame="true" width="671" height="455" layout="absolute" onOk="if (!extVerifyAllControls('extWindow')) return;;&#xA;&#xA;&#xA;if(BEGIN_TIM.getValue()!=''&amp;&amp;END_TIM.getValue()!='')&#xA;{&#xA;&#xA;	if(BEGIN_TIM.getValue()&gt;=END_TIM.getValue())&#xA;	{&#xA;		extShowMessage('开工时间比结束时间晚！请重新输入');&#xA;		return;&#xA;	}&#xA;}&#xA;&#xA;if(operateType=='insert'){&#xA;	insertAjax();&#xA;&#xA;}&#xA;if(operateType=='modify'){&#xA;	updatetAjax();&#xA;	&#xA;}" onHide="extResetAllControlsValue('extWindow');" caption="设备事故处理单" autoScroll="true"><extLabel name="extLabel" left="210" top="15" width="75" caption="设备中文名："/><extComboBox mode="local" left="80" top="10" width="120" name="DEV_NAM" store="shipDevStore" displayField="NAME" valueField="NAME" pageSize="15" listWidth="200" minChars="2" typeAhead="2" onSelect="var  v=control.value;&#xA;C_DEV_NAM.setValue(v.split('(')[1].split('-')[0]);&#xA;E_DEV_NAM.setValue(v.split('(')[1].split('-')[1].split(')')[0]);&#xA;DEV_NO.setValue(v.split('(')[0]);" onExpand="shipDevStore.load(&#xA;{params:{start:0,limit:30,shipCod:shipCod.getValue()}}&#xA;);" allowBlank="false" onFocus="shipDevStore.load(&#xA;{params:{start:0,limit:30,shipCod:shipCod.getValue()}}&#xA;);"/><extTextField left="290" top="10" width="120" name="C_DEV_NAM"/><extLabel name="extLabel1" left="425" top="15" width="80" caption="设备英文名："/><extTextField left="510" top="10" width="120" name="E_DEV_NAM"/><extLabel name="extLabel2" left="5" top="15" width="70" html="&lt;font  color='red'&gt;*&lt;/font&gt;设备号："/><extLabel name="extLabel3" left="5" top="45" width="70" caption="报修人："/><extTextField left="80" top="40" width="120" name="APPLY_MAN_COD"/><extLabel name="extLabel4" left="210" top="45" width="75" caption="报修部门："/><extTextField left="290" top="40" width="120" name="APPLY_DEPT_COD"/><extLabel name="extLabel5" left="420" top="45" width="85" caption="报修日期："/><extDate left="510" top="40" width="120" name="APPLY_TIM"/><extLabel name="extLabel6" left="5" top="75" width="70" caption="派工员："/><extTextField left="80" top="70" width="120" name="ASSIGN_MAN_COD"/><extLabel name="extLabel7" left="210" top="75" width="75" caption="派工部门："/><extTextField left="290" top="70" width="120" name="ASSIGN_DEPT_COD"/><extLabel name="extLabel8" left="425" top="75" width="80" caption="派工日期："/><extDate left="510" top="70" width="120" name="ASSIGN_TIM"/><extLabel name="extLabel9" left="5" top="105" width="70" caption="反馈人："/><extTextField left="80" top="100" width="120" name="FEEDBACK_MAN_COD"/><extLabel name="extLabel10" left="215" top="105" width="70" caption="反馈部门："/><extTextField left="290" top="100" width="120" name="FEEDBACK_DEPT_COD"/><extLabel name="extLabel11" left="420" top="105" width="85" caption="反馈时间："/><extDate left="510" top="100" width="120" name="FEEDBACK_TIM"/><extLabel name="extLabel12" left="15" top="135" width="60" caption="故障描述："/><extTextField left="80" top="130" width="330" name="DEV_HITCH_EXPRESS" inputType="textArea" height="50" maxLength="500"/><extCheckBox left="445" top="130" width="185" height="20" name="UP_ID" boxLabel="是否报修"/><extCheckBox left="445" top="160" width="185" height="15" name="ASSIGN_ID" boxLabel="是否派工"/><extLabel name="extLabel13" left="5" top="190" width="70" caption="解决办法："/><extTextField left="80" top="190" width="330" name="DEV_HITCH_RESOLVENT" inputType="textArea" height="55"/><extLabel name="extLabel14" left="420" top="190" width="85" caption="故障部位："/><extTextField left="510" top="185" width="120" name="DEV_PART_COD" maxLength="10"/><extLabel name="extLabel15" left="420" top="220" width="85" caption="故障原因："/><extTextField left="510" top="215" width="120" name="DEV_HITCH_REASON"/><extLabel name="extLabel16" left="5" top="260" width="70" caption="开工时间："/><extDate left="80" top="255" width="120" name="BEGIN_TIM"/><extLabel name="extLabel17" left="210" top="260" width="75" caption="结束时间："/><extDate left="290" top="255" width="120" name="END_TIM"/><extCheckBox left="445" top="245" width="185" height="25" name="REPAIR_ID" boxLabel="故障是否修复"/><extLabel name="extLabel18" left="5" top="290" width="70" caption="验收意见："/><extTextField left="80" top="285" width="330" name="PROCESS_DES" inputType="textArea" height="50"/><extLabel name="extLabel19" left="420" top="285" width="85" caption="维修工人名单："/><extTextField left="510" top="280" width="120" name="REPAIR_WORKER_NAM" maxLength="50"/><extLabel name="extLabel20" left="425" top="315" width="80" caption="验收人："/><extTextField left="510" top="310" width="120" name="ACCEPT_MAN"/><extLabel name="extLabel21" left="5" top="350" width="70" caption="外包单位："/><extTextField left="80" top="345" width="120" name="OUT_REPAIR_CORP"/><extLabel name="extLabel22" left="200" top="350" width="85" caption="外包维修人："/><extTextField left="290" top="345" width="120" name="OUT_REPAIR_MAN"/><extLabel name="extLabel23" left="410" top="345" width="95" caption="故障类型代码："/><extComboBox mode="local" left="510" top="340" width="120" name="HITCH_TYP_COD" store="hichStore" displayField="NAME" valueField="NAME" pageSize="15" listWidth="200"/><extLabel name="extLabel24" left="10" top="380" width="65" caption="维修费用："/><extNumber left="80" top="375" width="120" name="REPAIR_MONEY_NUM"/><extLabel name="extLabel25" left="210" top="380" width="75" caption="验收时间："/><extDate left="290" top="375" width="120" name="ACCEPT_TIM"/><extCheckBox left="420" top="370" width="100" height="20" name="UP_ID2" boxLabel="上报标志"/><extCheckBox left="530" top="370" width="100" height="20" name="ACCEPT_ID" boxLabel="验收标志"/><extTextField name="BILL_NO" hidden="true" left="140" top="425" width="120"/><extTextField left="320" top="430" width="120" name="DEV_NO" hidden="true"/></extWindow><extViewPort name="viewPort" layout="fit"><extPanel name="panel1" border="false" region="center" layout="fit" width="500" height="350" tbar="menu"><extGrid name="grid" columnsModel="columnCertificate" region="south" height="200" store="store" pageSize="30" loadStore="false" onCellDblClick="extCall(editMenu);"/></extPanel></extViewPort></body>
