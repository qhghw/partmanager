<?xml version="1.0" encoding="utf-8"?>
<body name="body" class="sys_normal" headerScript="var nodetype,receive_man2;&#xA;Ext.override(Ext.ux.form.LovCombo, {   &#xA;beforeBlur: Ext.emptyFn&#xA; });" extHeaderScript="var  dialog = new Ext.ux.UploadDialog.Dialog({&#xA;	                 url: '/PartManager/jsp/fileupload/upload.jsp',&#xA;		          width : 450,&#xA;		          height : 300,&#xA;		          minWidth : 450,&#xA;		          minHeight : 300,&#xA;		          draggable : true,&#xA;		          resizable : true,&#xA;		          modal: true,&#xA;	                 reset_on_hide: false,&#xA;	                 allow_close_on_upload: false,  &#xA;	                 upload_autostart: false &#xA;	               });" jsFiles="Ext.ux.UploadDialog/Ext.ux.UploadDialog.packed.js|webbuilder/script/LovCombo.js" cssFiles="Ext.ux.UploadDialog/UploadDialog/css/Ext.ux.UploadDialog.css|webbuilder/css/Ext.ux.form.LovCombo.css">
	<folder name="filemanage"><folder name="store"><extStore name="mainselect" url="main?action=webbuilder/application/partmanager/filemanage/store/selectUpload.xwl" autoLoad="true"/><extAjax out="maingrid" onSuccess="extRemoveGridSelection(maingrid);" name="maindeleted" url="main?action=webbuilder/application/partmanager/filemanage/store/delete.xwl"/><extStore name="getReceiveMan" url="main?action=webbuilder/application/partmanager/common/CodeSelect.xwl" baseParams="fldId:'7'"/><extAjax url="main?action=webbuilder/application/partmanager/filemanage/store/save.xwl" out="mainWindow" onSuccess="extShowMessage('新增成功！');&#xA;mainWindow.hide();&#xA;mainselect.baseParams=extGetAllControlsValue('mainmenu');&#xA;mainselect.load({params:{start:0,limit:30}});" name="mainsave"/><extAjax url="main?action=webbuilder/application/partmanager/filemanage/store/update.xwl" out="mainWindow" onSuccess="extShowMessage('操作成功！');&#xA;mainWindow.hide();&#xA;mainselect.baseParams=extGetAllControlsValue('mainmenu');&#xA;mainselect.load({params:{start:0,limit:30}});" name="mainupdate"/><extStore url="main?action=webbuilder/application/partmanager/filemanage/store/detailselect.xwl" autoLoad="false" name="detailselect"/><extAjax name="importRequest" form="importForm" isUpload="true" url="main?action=webbuilder/application/partmanager/filemanage/store/import.xwl" onSuccess="importWindow.hide();&#xA;if(response.responseText!=&quot;&quot;)&#xA;{&#xA;&#xA;detailselect.baseParams=extGetAllControlsValue('mainmenu');&#xA;detailselect.load({params:{start:0,limit:30}});&#xA;}" out="mainmenu"/><extStore url="main?action=webbuilder/application/partmanager/system/usersDao/usersQuery.xwl" name="trusttypstore" showMessage="false" autoLoad="true"/></folder><folder name="column"><extColumnModel name="mainModel"><extColumn width="100" align="center" name="_id" fieldName="id" hidden="true" caption="主键"/><extColumn width="100" align="center" name="_file_type" fieldName="file_type" caption="主题"/><extColumn name="_receive_man" fieldName="receive_man" caption="接收人" align="center" width="200"/><extColumn name="_describe" fieldName="file_describe" caption="文件描述" align="left" width="200"/><extColumn name="_RECORD_TIM" fieldName="RECORD_TIM" caption="录入时间"/><extColumn name="_RECORD_MAN" fieldName="RECORD_MAN" caption="录入人"/><extColumn name="_DEPT_COD" fieldName="DEPT_COD" caption="所属部门"/><extColumn fieldName="USERID" name="_USERID" caption="用户代码"/><extColumn name="_REMARKS" fieldName="REMARKS" caption="备注"/></extColumnModel><extColumnModel name="detailModel"><extColumn name="id_" caption="ID" fieldName="id" hidden="true"/><extColumn caption="caption" name="manageid" fieldName="manageid" hidden="true"/><extColumn name="filename_" caption="文件名称" fieldName="filename" align="left" width="250"/><extColumn name="filesize_" caption="文件大小" fieldName="filesize" align="center" width="100"/><extColumn name="filetype_" caption="文件类型" fieldName="filetype" align="center" width="100"/><extColumn name="uploadman_" caption="上传人" align="center" width="100" fieldName="uploadman"/></extColumnModel></folder><folder name="menu"><extMenu name="mainmenu"><extLabel name="filetype_toolbar" caption="文件类型"/><extTextField name="fileType"/><extMenuItem name="mainsearch" caption="查询" iconCls="icon_property" onClick="var fileTypeValue=fileType.getValue()==null?'':fileType.getValue();&#xA;mainselect.baseParams.whereSql=&quot; where file_type like '%&quot;+fileTypeValue+&quot;%' &quot;;&#xA;mainselect.load({params:{start:0,limit:30}});"/><extMenuItem name="maindel" caption="删除" iconCls="icon_delete" onClick="maingrid=Ext.getCmp(&quot;maingrid&quot;);&#xA;extGridDeleteConfirm(maingrid,&quot;file_type&quot;,function(){&#xA;	maindeleted();&#xA;});"/><extMenuItem name="mainedit" caption="修改" iconCls="icon_edit" onClick="operateType = 'modify';&#xA;maingrid=Ext.getCmp(&quot;maingrid&quot;);&#xA;if (maingrid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一个有效的条目。');&#xA;	return;&#xA;}else{&#xA;	var record = maingrid.getSelectionModel().getSelected();&#xA;		mainWindow.show();&#xA;	extSetAllControlsValueObj(mainWindow, record.data);&#xA;receive_man2.setValue(receive_man.getValue());&#xA;}"/><extMenuItem name="uploadpage" onClick="if (maingrid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一条数据。');&#xA;	return;&#xA;}else{	&#xA;	var record = maingrid.getSelectionModel().getSelected();&#xA;	var typeid=record.data.id;&#xA;	&#xA;importType.setValue(0);&#xA;importDir.setValue(&quot;E:\\partmanager\\upload\\&quot;);&#xA;importWindow.show();&#xA;}" iconCls="icon_edit" caption="添加附件"/><extMenuItem name="mainadd" caption="添加" iconCls="icon_new" onClick="mainWindow.setTitle('新增');&#xA;mainWindow.show();&#xA;operateType = 'insert';&#xA;extResetAllControlsValue(&quot;mainWindow&quot;);&#xA;receive_man2.setValue('');"/><extTextField name="FILENAME_IMG" disabled="true" hidden="true"/><extTextField name="mainId" hidden="true"/></extMenu><extMenu name="menu1"><extMenuItem name="download" caption="下载" iconCls="icon_edit" onClick="if (detailgrid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一条数据。');&#xA;	return;&#xA;}else{	&#xA;	var record = detailgrid.getSelectionModel().getSelected();&#xA;	var fileid=record.data.id;&#xA;	window.location.href = &quot;servlet/download?id=&quot;+fileid;&#xA;}"/></extMenu></folder><folder name="script"/><folder name="window"><extWindow name="uploadWindow" closeAction="hide" frame="true" layout="absolute" caption="文件上传" border="0" width="500" height="500"><iframe name="iframe" width="100%" height="100%"/></extWindow><extWindow closeAction="hide" frame="true" width="505" height="323" layout="absolute" name="mainWindow" caption="添加" onOk="if (!extVerifyAllControls('mainWindow')) return;&#xA;if (operateType == 'insert'){&#xA;mainsave();&#xA;} else mainupdate();" onShow="extResetAllControlsValue('mainWindow');"><extTextField name="id" hidden="true" left="10" top="230" width="85"/><extLabel name="file_type_Label" caption="主题：" left="15" top="20" width="70"/><extTextField name="file_type" left="100" top="15" width="120"/><extLabel name="receive_man_Label" caption="接收人：" left="20" top="50" width="70"/><extLabel name="file_describe_Label" caption="文件描述：" left="15" top="80" width="70"/><extTextField name="file_describe" inputType="textArea" left="100" top="80" width="360" height="50"/><extLabel name="REMARKS_Label" caption="备注：" left="15" top="125" width="70"/><extTextField name="REMARKS" inputType="textArea" left="100" top="140" width="360" height="55"/><extScript name="extScript" left="100" top="45" width="360" height="20" extLast="receive_man2=new Ext.ux.form.LovCombo(&#xA;{&#xA;id:&quot;receive_man2&quot;,&#xA;name:&quot;receive_man2&quot;,&#xA;mustSelection:true,&#xA;invalidText:&quot;请选择列表中的值&quot;,&#xA;selectOnFocus:true,&#xA;store:trusttypstore,&#xA;hideOnSelect:false,&#xA;displayField:&quot;USERNAME&quot;,&#xA;valueField:&quot;USERNAME&quot;,&#xA;forceSelection:true,&#xA;listWidth:350,&#xA;width:360,&#xA;x:100,&#xA;y:45,&#xA;triggerAction:&quot;all&quot;,&#xA;mode:'local',&#xA;listeners:{&#xA;blur:function(control)&#xA;{&#xA;control.lastSelectionText = control.el.dom.value;&#xA;receive_man.setValue(receive_man2.getValue());&#xA;&#xA;}&#xA;}&#xA;});&#xA;mainWindow.add(receive_man2);"/><extTextField left="100" top="45" width="360" name="receive_man" hidden="true"/></extWindow><extWindow name="importWindow" closeAction="hide" iconCls="icon_import" layout="absolute" frame="true" onOk="if (!extVerifyAllControls('importWindow')) return; &#xA;var filetype=importFile.getValue();&#xA;var extend = filetype.substring(filetype.lastIndexOf(&quot;.&quot;)+1); &#xA;if(extend==&quot;&quot;){ &#xA;	extShowMessage(&quot;请选择系统支持的文件类型的文件！&quot;);&#xA;	return false;&#xA;}&#xA;importRequest();" width="415" height="185" caption="文件上传"><extForm name="importForm" frame="true" layout="absolute" left="10" top="5" width="380" height="110"><extLabel name="extLabel1111" caption="请选择要上传的文件：" align="left" left="15" top="20" width="265"/><extTextField name="importFile" inputType="file" allowBlank="false" left="10" top="55" width="265"/><extTextField inputType="hidden" name="importDir" height="50" left="520" top="15" width="55"/><extTextField inputType="hidden" name="importType" left="520" top="45" width="60"/></extForm></extWindow></folder></folder><extViewPort name="viewPort" layout="border"><extGrid name="maingrid" store="mainselect" pageSize="10" columnsModel="mainModel" tbar="mainmenu" width="100%" loadStore="true" region="north" height="300" onRowClick="var record = maingrid.getSelectionModel().getSelected();&#xA;mainId.setValue(record.data.id);&#xA;detailselect.baseParams.whereSql=&quot; where manageid = '&quot;+record.data.id+&quot;'&quot;;&#xA;detailselect.load({params:{start:0,limit:30}});"/><extGrid store="detailselect" pageSize="10" columnsModel="detailModel" width="100%" loadStore="false" name="detailgrid" region="center" height="250" tbar="menu1"/></extViewPort></body>
