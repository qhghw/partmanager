<?xml version="1.0" encoding="utf-8"?>
<body name="body" compact="true" class="sys_normal" caption="物料采购申请" headerScript="var operateType ;var nodetype;var purtype;">
	<folder name="storeFolder">
		<extStore name="mainselect" url="main?action=webbuilder/application/partmanager/tApply/store/mainselect.xwl" autoLoad="false"/>
		<extAjax url="main?action=webbuilder/application/partmanager/tApply/store/mainsave.xwl" out="mainWindow" onSuccess="extShowMessage('新增成功！');&#xA;mainWindow.hide();&#xA;mainselect.baseParams=extGetAllControlsValue('mainmenu');&#xA;mainselect.load({params:{start:0,limit:30}});" name="mainsave"/>
		<extAjax url="main?action=webbuilder/application/partmanager/tApply/store/mainupdate.xwl" out="mainWindow" onSuccess="extShowMessage('操作成功！');&#xA;mainWindow.hide();&#xA;mainselect.baseParams=extGetAllControlsValue('mainmenu');&#xA;mainselect.load({params:{start:0,limit:30}});" name="mainupdate"/>
		<extAjax url="main?action=webbuilder/application/partmanager/tApply/store/maindelete.xwl" onSuccess="extRemoveGridSelection(maingrid);&#xA;mainselect.baseParams=extGetAllControlsValue('mainmenu');&#xA;mainselect.load({params:{start:0,limit:30}});" out="maingrid" showMessage="true" name="maindelete"/>
		<extStore name="detailselect" url="main?action=webbuilder/application/partmanager/tApply/store/detailselect.xwl" autoLoad="false"/><extAjax out="detailWindow" name="detailsave" url="main?action=webbuilder/application/partmanager/tApply/store/detailsave.xwl" onFailure="var s = response.responseText;&#xA;extShowExcept(s);" onSuccess="extShowMessage('新增成功！');extCall(detailsearch);detailWindow.hide();"/><extAjax name="detailupdate" url="main?action=webbuilder/application/partmanager/tApply/store/detailupdate.xwl" out="detailWindow" onSuccess="extShowMessage('新增成功！');extCall(detailsearch);detailWindow.hide();" onFailure="var s = response.responseText;&#xA;extShowExcept(s);"/><extAjax out="detailgrid" onSuccess="extRemoveGridSelection(detailgrid);" name="detaildeleted" url="main?action=webbuilder/application/partmanager/tApply/store/detaildeleted.xwl"/><extAjax url="main?action=webbuilder/application/common/getSql.xwl" out="detailWindow" onSuccess="alert(&quot;保存成功！&quot;);" onFailure="alert(&quot;保存失败&quot;);" name="getSql"/><method name="getOrg" methodName="com.xuelang.partmanage.MultipleTree.getOrg"/><extStore name="getInStoreType" url="main?action=webbuilder/application/partmanager/common/CodeSelect.xwl" baseParams="fldId:'13'"/><extStore name="getInPurchType" url="main?action=webbuilder/application/partmanager/common/CodeSelect.xwl" baseParams="fldId:'10'"/><extAjax url="main?action=webbuilder/application/partmanager/tApply/store/startProcess.xwl" onSuccess="extShowMessage('发起成功！');" onFailure="extShowMessage('发起失败！');" out="maingrid" name="ajaxStartProcess"/><extAjax name="ajaxViewprocess" url="main?action=webbuilder/application/partmanager/outApply/store/viewProcess.xwl"/><extStore url="main?action=webbuilder/application/partmanager/wasteApply/wasteApply/selectprocess.xwl" autoLoad="true" name="selectprocess"/><extStore name="getDwStore" baseParams="fldId:'1'" url="main?action=webbuilder/application/partmanager/common/CodeSelect.xwl"/></folder>
	<folder name="column"><extTextField autoShow="false" name="PURTXT"/><extTextField name="PARTS_COD1" autoShow="false"/><extTextField name="C_PARTS_NAM1" autoShow="false"/><extTextField name="E_NAME" autoShow="false"/><extTextField name="STAND_TXT1" autoShow="false"/><extNumber name="CHECK_NUM" maxValue="9999999" allowDecimals="true" decimalPrecision="2" autoShow="false"/><extComboBox mode="remote" name="PUR_WAY_COD2" store="getInStoreType" displayField="RNAME" valueField="RNAME" pageSize="15" listWidth="125" autoShow="false"/><extComboBox mode="local" name="MIN_UNIT1" store="getDwStore" valueField="RNAME" displayField="RNAME" pageSize="15" autoShow="false"/><extColumnModel name="mainModel"><extColumn caption="申请号" fieldName="PUR_NO" align="center" name="_PUR_NO"/><extColumn caption="申请日期" fieldName="PUR_DTE" width="140" align="center" name="_PUR_DTE"/><extColumn caption="申请部门" fieldName="APPLY_DEPT_COD" align="left" name="_APPLY_DEPT_COD"/><extColumn fieldName="PARTS_TYPE" align="center" name="_PARTS_TYPE" caption="物料类型"/><extColumn caption="采购方式" fieldName="PUR_WAY_COD" align="center" name="_PUR_WAY_COD"/><extColumn name="_PAY_MOD" caption="付款方式" fieldName="PAY_MOD" align="center"/><extColumn caption="负责人" fieldName="MANA_MAN" align="center" name="_MANA_MAN"/><extColumn caption="采购说明" fieldName="PUR_TXT" align="left" name="_PUR_TXT"/><extColumn fieldName="IS_URGENT" align="center" name="_IS_URGENT" renderer="if(value=='0')&#xA;return '否';&#xA;else if(value=='1')&#xA;return '是';" caption="是否急用"/><extColumn name="_WF_STATUE" fieldName="WF_STATUE" caption="流程状态" align="center" renderer="if(value==1){&#xA;return '正在审批';&#xA;}else if(value==2){&#xA;return '审批通过';&#xA;}else if(value==3){&#xA;return '未通过';&#xA;}else{&#xA;return '未审批';&#xA;}"/><extColumn caption="录入时间" fieldName="RECORD_TIM" width="140" align="center" name="_RECORD_TIM"/><extColumn caption="录入人" fieldName="RECORD_MAN" align="center" name="_RECORD_MAN"/><extColumn caption="备注" fieldName="REMARKS" align="center" name="_REMARKS_"/></extColumnModel><extColumnModel name="detailModel"><extColumn name="_PARTS_COD_" caption="代码" editor="PARTS_COD1" fieldName="PARTS_COD"/><extColumn name="_C_PARTS_NAM_" caption="中文名称" align="left" editor="C_PARTS_NAM1" fieldName="C_PARTS_NAM"/><extColumn name="_E_PARTS_NAM_" caption="英文名称" align="center" editor="E_NAME" fieldName="E_PARTS_NAM"/><extColumn name="_STAND_TXT_" caption="规格" align="left" editor="STAND_TXT1" fieldName="STAND_TXT"/><extColumn name="_PUR_TXT_" caption="采购说明" align="left" editor="PURTXT" fieldName="PUR_TXT"/><extColumn name="_PUR_NUM_" caption="采购数量" align="center" editor="CHECK_NUM" fieldName="PUR_NUM"/><extColumn name="MIN_UNIT_2" caption="单位" width="80" align="center" editor="MIN_UNIT1" fieldName="MIN_UNIT"/><extColumn name="_PUR_WAY_COD_" caption="采购方式" align="center" editor="PUR_WAY_COD2" fieldName="PUR_WAY_COD"/><extColumn name="_RECORD_TIM_" caption="录入时间" fieldName="RECORD_TIM" align="center"/><extColumn name="_RECORD_MAN_" fieldName="RECORD_MAN" caption="录入人" align="center"/><extColumn name="_REMARKS__" fieldName="REMARKS" caption="备注"/><extColumn caption="caption" name="_PUR_NO_" hidden="false" fieldName="PUR_NO"/></extColumnModel><extColumnModel name="columnProcess"><extColumn name="username_" fieldName="username" caption="发起人" align="center" width="80"/><extColumn name="starttime_" fieldName="starttime" caption="发起时间" align="center" width="100"/><extColumn name="taskname_" fieldName="taskname" caption="审核阶段" align="center" width="100"/><extColumn name="checkman_" fieldName="checkman" caption="审核人" align="center" width="80"/><extColumn name="begintime_" fieldName="begintime" caption="到达日期" align="center" width="100"/><extColumn name="endtime_" fieldName="endtime" caption="完成日期" align="center" width="100"/><extColumn name="duration_" fieldName="duration" caption="过程耗时(H)" align="center" width="100"/><extColumn name="status_" fieldName="status" caption="状态" align="center" width="80"/></extColumnModel></folder><folder name="menu"><extMenu name="mainmenu" style="" bodyStyle="" autoShow="false"><extLabel name="PUR_NO" caption="申请单号"/><extTextField name="purNo"/><extMenuItem onClick="var purno =purNo.getValue()==null?'':purNo.getValue();&#xA;mainselect.baseParams.whereSql=&quot; where PUR_NO like '%&quot;+purno +&quot;%' and PARTS_TYPE like '%&quot;+nodetype+&quot;%'&quot;;&#xA;mainselect.load({params:{start:0,limit:30}});" caption="查询" iconCls="icon_find" name="menusearch"/><extMenuItem iconCls="icon_new" caption="增加" onClick="mainWindow.setTitle('新增');&#xA;mainWindow.show();&#xA;operateType = 'insert';&#xA;extResetAllControlsValue(&quot;mainWindow&quot;);&#xA;&#xA;PARTS_TYPE.setValue(nodetype);&#xA;APPLY_DEPT_COD.setValue('{#sys.deptCode#}'); &#xA;MANA_MAN.setValue('{#sys.username#}');&#xA;var d = new Date();&#xA;var year = d.getFullYear();&#xA;var month = d.getMonth() + 1; &#xA;month = month &lt; 10 ? (&quot;0&quot; + month) : month;&#xA;var dt = d.getDate();&#xA;dt = dt &lt; 10 ? (&quot;0&quot; + dt) : dt;&#xA;var today= year + &quot;-&quot; + month + &quot;-&quot; + dt;&#xA;PUR_DTE.setValue(today);" name="mainadd"/><extMenuItem caption="编辑" iconCls="icon_edit" onClick="operateType = 'modify';&#xA;maingrid=Ext.getCmp(&quot;maingrid&quot;);&#xA;if (maingrid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一个有效的条目。');&#xA;	return;&#xA;}else{&#xA;	var record = maingrid.getSelectionModel().getSelected();&#xA;		mainWindow.show();&#xA;	extSetAllControlsValueObj(mainWindow, record.data);&#xA;&#xA;}" name="mainedit"/><extMenuItem iconCls="icon_delete" caption="删除" onClick="maingrid=Ext.getCmp(&quot;maingrid&quot;);&#xA;extGridDeleteConfirm(maingrid,&quot;PUR_NO&quot;,function(){&#xA;	maindelete();&#xA;});" name="maindel"/><extMenuItem name="startprocess" caption="发起流程" onClick="if (maingrid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一条数据。');&#xA;	return;&#xA;}else{	&#xA;	var record = maingrid.getSelectionModel().getSelected();&#xA;	ajaxStartProcess();&#xA;}" iconCls="icon_edit"/><extMenuItem caption="流程进度" name="showprocess" onClick="if (maingrid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一条数据。');&#xA;	return;&#xA;}else{	&#xA;	var record = maingrid.getSelectionModel().getSelected();&#xA;	var wfstatus=record.data.WF_STATUE;&#xA;	if(wfstatus==1){&#xA;		Get('image').src='/PartManager/modelFlowImage_getProcessTask.do?processinstid='+record.data.processinstid;&#xA;		var  wheresql=&quot; where  procinstid='&quot;+record.data.processinstid+&quot;' &quot;;&#xA;		selectprocess.baseParams.whereSql = wheresql;&#xA;		selectprocess.load({params:{start:0,limit:30}});&#xA;&#xA;		detailselect.baseParams.whereSql=&quot; where PUR_NO = '&quot;+record.data.PUR_NO+&quot;'&quot;;&#xA;		detailselect.load({params:{start:0,limit:30}});&#xA;&#xA;		PUR_DTE1.setValue(record.data.PUR_DTE);&#xA;		PARTS_TYPE1.setValue(record.data.PARTS_TYPE);&#xA;		MANA_MAN1.setValue(record.data.MANA_MAN);&#xA;		PUR_TXT1.setValue(record.data.PUR_TXT);&#xA;		REMARKS1.setValue(record.data.REMARKS);&#xA;		APPLY_DEPT_COD1.setValue(record.data.APPLY_DEPT_COD);&#xA;		PAY_MOD1.setValue(record.data.PAY_MOD);&#xA;		PUR_WAY_COD1.setValue(record.data.PUR_WAY_COD);&#xA;		IS_URGENT1.setValue(record.data.IS_URGENT);&#xA;&#xA;				&#xA;		processViewWindow.show();&#xA;&#xA;	}else{&#xA;		extShowWarning('尚未发起审批。');&#xA;	}&#xA;}" iconCls="icon_edit"/></extMenu><extMenu name="detailmenu"><extLabel name="C_PARTS_NAM_toolbar1" caption="物料名称"/><extTextField name="partsName" width="80"/><extLabel caption="物料编码" name="PARTS_COD_TOOL"/><extTextField name="partsCod" width="80"/><extMenuItem name="detailsearch" caption="查询" iconCls="icon_property" onClick="var record = maingrid.getSelectionModel().getSelected();&#xA;detailselect.baseParams.putNo= record.data.PUR_NO ;&#xA;var partscode=partsCod.getValue()==null?'':partsCod.getValue();&#xA;var partsname =partsName.getValue()==null?'':partsName.getValue();&#xA;detailselect.baseParams.whereSql=&quot; and  PARTS_COD like '%&quot;+partscode+&quot;%' and C_PARTS_NAM like '%&quot;+partsname+&quot;%'&quot;;&#xA;detailselect.load({params:{start:0,limit:30}});"/><extMenuItem name="detailadd" caption="增加" onClick="if(purtype==null){&#xA;	extShowWarning('请选择一个有效申请。');&#xA;	return false;&#xA;}else{&#xA;	detailWindow.setTitle('新增');&#xA;	detailWindow.show();&#xA;	operateType = 'insert';&#xA;	extResetAllControlsValue(&quot;detailWindow&quot;);&#xA;	var record = maingrid.getSelectionModel().getSelected();&#xA;	PUR_NO_.setValue(record.get('PUR_NO'));&#xA;	PUR_WAY_COD_.setValue(purtype);&#xA;}" iconCls="icon_new"/><extMenuItem name="detaildel" caption="删除" iconCls="icon_delete" onClick="extRemoveGridSelection(detailgrid);"/><extMenuItem name="detailedit" caption="修改" iconCls="icon_edit" onClick="operateType = 'modify';&#xA;detailgrid=Ext.getCmp(&quot;detailgrid&quot;);&#xA;&#xA; &#xA;var sm = detailgrid.getSelectionModel();&#xA;var celIndex = sm.getSelectedCell();&#xA;var record = detailgrid.getStore().getAt(celIndex [0]);&#xA; &#xA;		detailWindow.show();&#xA;	extSetAllControlsValueObj(detailWindow, record.data);&#xA;	C_PARTS_NAM_.setValue(record.data.C_PARTS_NAM);&#xA;E_PARTS_NAM_.setValue(record.data.E_PARTS_NAM);&#xA;PUR_TXT_.setValue(record.data.PUR_TXT);&#xA;PUR_NUM.setValue(record.data.PUR_NUM);&#xA;PUR_WAY_COD_.setValue(record.data.PUR_WAY_COD);&#xA;REMARKS_.setValue(record.data.REMARKS);&#xA;PUR_NO_.setValue(record.data.PUR_NO);"/><extMenuItem name="menuItem" caption="保存" iconCls="icon_save" onClick="mulGridSave();"/></extMenu></folder><folder name="window"><extWindow name="mainWindow" frame="true" caption="物料采购申请维护" onShow="extResetAllControlsValue('mainWindow');" width="705" height="235" dialog="true" layout="absolute" closeAction="hide" onOk="if (!extVerifyAllControls('mainWindow')) return;&#xA;if (operateType == 'insert'){&#xA;mainsave();&#xA;} else mainupdate();"><extLabel caption="申请日期：" left="10" top="15" width="65" name="PUR_DTE_LAB"/><extDate name="PUR_DTE" left="80" top="10" width="130"/><extLabel caption="申请部门：" left="220" top="15" width="80" name="APPLY_DEPT_COD_LAB"/><extLabel caption="物料类型：" name="extLabel3" left="445" top="15" width="80"/><extTextField name="PARTS_TYPE" left="530" top="10" width="130" readOnly="true"/><extLabel caption="付款方式：" name="extLabel4" left="10" top="45" width="60"/><extLabel caption="采购方式：" name="extLabel5" left="220" top="40" width="80"/><extLabel caption="负责人：" name="extLabel6" left="440" top="45" width="85"/><extTextField name="MANA_MAN" left="530" top="40" width="130"/><extLabel caption="采购说明：" name="extLabel7" left="10" top="90" width="60"/><extTextField name="PUR_TXT" left="80" top="70" width="450" inputType="textArea" height="40"/><extLabel caption="备注：" name="extLabel18" left="10" top="135" width="60"/><extTextField name="REMARKS" left="80" top="120" width="580" inputType="textArea" height="45"/><extComboTree left="305" top="10" width="125" height="20" name="APPLY_DEPT_COD" data="{#orgTree#}" onClick="var text=node.text;&#xA;APPLY_DEPT_COD.setValue(text);&#xA;APPLY_DEPT_COD.collapse();"/><extComboBox mode="remote" name="PAY_MOD" left="80" top="40" width="130" store="getInPurchType" valueField="RNAME" displayField="RNAME" pageSize="15" listWidth="130"/><extComboBox mode="remote" name="PUR_WAY_COD" left="305" top="40" width="125" store="getInStoreType" displayField="RNAME" valueField="RNAME" pageSize="15" listWidth="125"/><extCheckBox left="550" top="75" width="105" height="25" name="IS_URGENT" boxLabel="是否急用"/><extTextField left="370" top="200" width="120" name="PUR_NO1" hidden="true"/></extWindow><extWindow name="detailWindow" frame="true" onOk="if (!extVerifyAllControls('detailWindow')) return; &#xA;if(operateType == 'insert'){&#xA;&#xA;	detailsave();&#xA;	&#xA;}&#xA;if(operateType == 'modify'){&#xA;	detailupdate();&#xA;}" width="813" height="216" layout="absolute" closeAction="hide" caption="出库明细" onHide="extResetAllControlsValue('detailWindow');"><extLabel caption="名称：" name="extLabel2" left="270" top="10" width="100"/><extTextField name="C_PARTS_NAM_" left="385" top="5" width="130"/><extLabel caption="代码：" name="extLabel31" left="10" top="10" width="100"/><extTextField left="115" top="5" width="130" name="PARTS_COD"/><extLabel caption="规格：" name="extLabel41" left="535" top="10" width="100"/><extTextField name="STAND_TXT" left="640" top="5" width="130"/><extLabel caption="采购说明：" name="extLabel51" left="10" top="35" width="100"/><extTextField name="PUR_TXT_" left="115" top="30" width="130"/><extLabel caption="采购数量：" name="extLabel61" left="270" top="35" width="100"/><extTextField name="PUR_NUM" left="385" top="30" width="130"/><extLabel caption="采购方式：" name="extLabel71" left="535" top="35" width="100"/><extTextField name="PUR_WAY_COD_" left="640" top="30" width="130"/><extLabel caption="备注：" name="extLabel12" left="10" top="85" width="100"/><extTextField name="REMARKS_" left="115" top="65" width="655" inputType="textArea" height="65"/><extTextField name="PUR_NO_" hidden="true" left="25" top="150" width="120"/></extWindow><extWindow closeAction="hide" frame="true" name="processViewWindow" caption="审批进度" width="800" height="550"><extTab activeTab="0" deferredRender="false" region="center" name="detailtab"><extPanel name="flowPanel" border="false" caption="审批明细" layout="absolute" width="801" height="462"><extGrid store="selectprocess" left="10" top="5" width="765" height="205" name="tasklist" columnsModel="columnProcess"/><extForm name="imagemodel" left="15" top="215" width="760" height="190"><image name="image"/></extForm></extPanel><extPanel border="false" layout="absolute" width="800" height="500" name="businessPanel" caption="报废明细"><extForm name="mainForm" left="10" top="10" width="770" height="110" layout="absolute" frame="true"><extLabel caption="申请日期：" left="10" top="15" width="65" name="PUR_DTE_LAB1"/><extTextField name="PARTS_TYPE1" left="530" top="5" width="130" readOnly="true"/><extDate name="PUR_DTE1" left="80" top="10" width="130"/><extLabel caption="申请部门：" left="220" top="15" width="80" name="APPLY_DEPT_COD_LAB1"/><extLabel caption="物料类型：" name="extLabel32" left="445" top="10" width="80"/><extLabel caption="付款方式：" name="extLabel42" left="10" top="40" width="60"/><extLabel caption="采购方式：" name="extLabel52" left="220" top="35" width="80"/><extLabel caption="负责人：" name="extLabel62" left="440" top="35" width="85"/><extTextField name="MANA_MAN1" left="530" top="30" width="130"/><extLabel caption="采购说明：" name="extLabel72" left="10" top="80" width="60"/><extTextField name="PUR_TXT1" left="80" top="60" width="450" inputType="textArea" height="40"/><extLabel caption="备注：" name="extLabel181" left="10" top="125" width="60"/><extTextField name="REMARKS1" left="80" top="110" width="580" inputType="textArea" height="45"/><extComboTree left="305" top="10" width="125" height="20" name="APPLY_DEPT_COD1" data="{#orgTree#}" onClick="var text=node.text;&#xA;APPLY_DEPT_COD.setValue(text);&#xA;APPLY_DEPT_COD.collapse();"/><extComboBox mode="remote" name="PAY_MOD1" left="80" top="35" width="130" store="getInPurchType" valueField="RNAME" displayField="RNAME" pageSize="15" listWidth="130"/><extComboBox mode="remote" name="PUR_WAY_COD1" left="305" top="35" width="125" store="getInStoreType" displayField="RNAME" valueField="RNAME" pageSize="15" listWidth="125"/><extCheckBox left="550" top="65" width="105" height="25" name="IS_URGENT1" boxLabel="是否急用"/></extForm><extGrid left="10" top="130" width="770" height="330" columnsModel="detailModel" name="detailgrid1" store="detailselect"/></extPanel></extTab></extWindow></folder><folder name="PartCodPackage"><extStore name="storeSuppli" url="main?action=webbuilder/application/partmanager/common/SuppliSelect.xwl"/><extStore name="partCodSelect" url="main?action=webbuilder/application/partmanager/common/partCodeStore.xwl" autoLoad="false"/><extScript name="extScript" extHeader="function extInsertRecordWt(store, index) {&#xA;	var fields = store.fields.items;&#xA;	var meta = Ext.data.Record.create(fields);&#xA;	var i, j = fields.length;&#xA;	var data = {};&#xA;&#xA;	for (i = 0; i &lt; j; i++)&#xA;		data[fields[i].name] = &quot;&quot;;&#xA;	var record = new meta(data);&#xA;	if (store.modified.indexOf(record) == -1)&#xA;		store.modified.push(record);&#xA;	if (index == null)&#xA;		store.add(record);&#xA;	else&#xA;		store.insert(index, record);&#xA;	return record;&#xA;}&#xA;function setPartCod()    &#xA;{&#xA;if (maingrid.getSelectionModel().getSelections().length != 1)&#xA;{&#xA;	extShowWarning('请选择一个有效的条目。');&#xA;	return;&#xA;}&#xA;var record = maingrid.getSelectionModel().getSelected();&#xA;&#xA;&#xA;var Temprows =  gridPartCod.getSelectionModel().getSelections();&#xA;     for (var ii = 0; ii &lt; Temprows.length; ii++){&#xA;		 tempRow=Temprows[ii];&#xA;                var r = extInsertRecordWt(detailselect,ii );&#xA;                r.set(&quot;PUR_NO&quot;,record.get('PUR_NO'));&#xA;		r.set(&quot;PARTS_COD&quot;,tempRow.data.PARTS_COD);&#xA;		r.set(&quot;C_PARTS_NAM&quot;,tempRow.data.C_PARTS_NAM);&#xA;		r.set(&quot;STAND_TXT&quot;,tempRow.data.STAND_TXT);&#xA;	 	r.set(&quot;MIN_UNIT&quot;,tempRow.data.MIN_UNIT);&#xA;		r.set(&quot;PUR_WAY_COD&quot;,record.get(&quot;PUR_WAY_COD&quot;));&#xA;	 	r.set(&quot;PUR_TXT&quot;,record.get(&quot;PUR_TXT&quot;));&#xA;&#xA;     }&#xA;}"/><extMenu name="menuPartCod"><extLabel caption="名称" name="partsNametool"/><extTextField name="partsName1" width="80"/><extLabel name="extLabel" caption="供应商"/><extComboBox mode="local" width="100" name="SUPPLIER_COD" store="storeSuppli" displayField="RNAME" valueField="RNAME" pageSize="30" onSelect="SUPPLIER_COD.setValue(this.value.split('/')[1]);" listWidth="150"/><extMenuItem name="search" caption="查询" iconCls="icon_property" onClick="var partscode=SUPPLIER_COD.getValue()==null?'':SUPPLIER_COD.getValue();&#xA;var partsname =partsName1.getValue()==null?'':partsName1.getValue();&#xA;partCodSelect.baseParams.whereSql=&quot; where SUPPLIER_NAM like  '%&quot;+partscode+&quot;%' and C_PARTS_NAM like '%&quot;+partsname+&quot;%'&quot;;&#xA;partCodSelect.load({params:{start:0,limit:100}});"/><extMenuItem name="menuItem1" caption="清空" iconCls="icon_delete" onClick="partsName1.setValue('');&#xA;SUPPLIER_COD.setValue('');"/><extMenuItem name="edit" iconCls="icon_ok" onClick="setPartCod();" caption="确认"/></extMenu><extColumnModel name="cmPartCod"><extScript name="extScript1" extHeader="new Ext.grid.CheckboxSelectionModel()"/><extColumn name="_PARTS_TYPE1" width="100" align="center" fieldName="PARTS_TYPE" caption="类型"/><extColumn name="_PARTS_COD1" fieldName="PARTS_COD" caption="代码"/><extColumn name="_C_PARTS_NAM1" fieldName="C_PARTS_NAM" caption="名称"/><extColumn width="80" name="_STAND_TXT1" fieldName="STAND_TXT" caption="型号"/><extColumn width="80" name="_STAND_UNIT" align="center" fieldName="STAND_UNIT" caption="标准单位"/><extColumn width="80" name="_MIN_UNIT" fieldName="MIN_UNIT" caption="最小单位"/><extColumn name="_STAND_CHANGE" fieldName="STAND_CHANGE" caption="转换率"/><extColumn width="60" name="_STORE_NUM" fieldName="STORE_NUM" caption="数量"/><extColumn width="80" name="_MIN_NUM" fieldName="MIN_NUM" caption="最小保有量"/><extColumn renderer="if(value=='0')&#xA;return '否';&#xA;else if(value=='1')&#xA;return '是';" name="_SUPPLIER_NAM" fieldName="SUPPLIER_NAM" caption="供应商名称"/></extColumnModel><extAjax name="mulGridSave" url="main?action=webbuilder/application/partmanager/tApply/store/mulGridSave.xwl" onSuccess="extShowMessage('新增成功！');extCall(detailsearch);" onFailure="var s = response.responseText;&#xA;extShowExcept(s);" out="detailgrid"/></folder><extViewPort name="viewPort" layout="border">
		<extPanel name="leftpanel" border="false" region="west" layout="fit" height="100%" caption="物料类型" width="150"><extTree name="tree" autoScroll="true" onBeforeLoad="control.baseParams.id=node.id;" remoteUrl="main?action=webbuilder/application/partmanager/common/jsonQueryParts.xwl" onClick="nodetype = node.text;&#xA;mainselect.baseParams.whereSql=&quot; where PARTS_TYPE = '&quot;+node.text+&quot;'&quot;;&#xA;mainselect.load({params:{start:0,limit:30}});"/></extPanel><extPanel name="rightpanel" border="false" region="center" layout="border" frame="true" hideMode="display" caption="采购申请单"><extGrid name="maingrid" bbar="" columnsModel="mainModel" autoExpandColumn="" onRowDblClick="extCall(editMenu);" downloadAll="true" pageSize="30" store="mainselect" loadStore="false" region="north" width="100%" height="300" tbar="mainmenu" onRowClick="var record = maingrid.getSelectionModel().getSelected();&#xA;detailselect.baseParams.putNo= record.data.PUR_NO ;&#xA;detailselect.load({params:{start:0,limit:30}});&#xA;purtype = record.data.PUR_WAY_COD;"/><extPanel name="panel" border="false" region="center" layout="border" height="400"><extPanel name="panel2" border="false" region="center" split="true" layout="border" height="400"><extGrid name="detailgrid" store="detailselect" columnsModel="detailModel" tbar="detailmenu" width="100%" loadStore="false" region="center" height="300" pageSize="30" canEdit="true" submitMode="modified" clicksToEdit="1"/></extPanel><extPanel name="panel1" border="false" region="east" collapsible="true" collapsed="true" split="true" layout="border" height="400" width="40%" caption="物料代码选择"><extGrid name="gridPartCod" region="center" split="true" columnsModel="cmPartCod" height="400" pageSize="100" tbar="menuPartCod" store="partCodSelect" loadStore="true"/></extPanel></extPanel></extPanel></extViewPort>
</body>
